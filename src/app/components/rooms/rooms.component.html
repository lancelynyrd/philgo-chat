


<ion-card *ngIf=" a.platform == 'cordova' && a.info && a.version < a.number(a.info.version) ">
  <ion-card-header>
    <ion-card-subtitle>{{ a.tr.t({ko: '앱을 업데이트해주세요.', en: 'Update app'}) }}</ion-card-subtitle>
    <ion-card-title>{{ a.tr.t({ko: '업데이트 알림', en: 'Update'}) }}</ion-card-title>
  </ion-card-header>
  <ion-card-content>
    <div>{{ a.tr.t({ko: '앱이 업데이트되었습니다. 업데이트된 앱을 설치해주세요.', en: 'Please update new version'}) }}</div>
    <a class="install-button" href="https://play.google.com/store/apps/details?id=com.sonub.chat" target="_blank">
      <span>{{ a.tr.t({ko: '채팅앱 설치하기', en: 'Install Chat App'}) }}</span>
      <ion-icon name="appstore"></ion-icon>
    </a>
  </ion-card-content>
</ion-card>


<ion-card *ngIf=" a.platform == 'web' && ! a.isPushNotificationPermissionRequested() ">
  <ion-card-header>
    <ion-card-subtitle>{{ a.tr.t({ko: '채팅 알림을 허용해주세요.', en: 'Please accept Notification'}) }}</ion-card-subtitle>
    <ion-card-title>{{ a.tr.t({ko: '채팅 알림', en: 'Allow Chat Notification'}) }}</ion-card-title>
  </ion-card-header>
  <ion-card-content>
    <div>{{ a.tr.t({ko: '채팅 알림을 허용 해 주셔야 새로운 채팅이 있을 시 알림을 받을 수 있습니다.', en: 'Please allow notification. So we can notify you when
      your friends talk to you.'}) }}</div>
    <ion-button color="danger" (click)=" a.requestPushNotificationPermission() ">
      <span>{{ a.tr.t({ko: '채팅 알림 허용하기', en: 'Allow Notification'}) }}</span>
      <ion-icon name="notifications"></ion-icon>
    </ion-button>
  </ion-card-content>
</ion-card>

<ion-card *ngIf=" a.platform == 'web' && a.isPushNotificationPermissionDenied() ">
  <ion-card-header>
    <ion-card-subtitle>{{ a.tr.t({ko: '채팅앱을 설치 해 주세요.', en: 'Please install chat app'}) }}</ion-card-subtitle>
    <ion-card-title>{{ a.tr.t({ko: '채팅앱 설치', en: 'Install Chat App'}) }}</ion-card-title>
  </ion-card-header>

  <ion-card-content>
    <div>{{ a.tr.t({ko: '채팅 알림을 거절하신 경우 반드시 채팅앱을 사용하시기 바랍니다.', en: 'You have denied chat notification. Please install Chat App
      to be notified.'}) }}</div>
    <ion-button routerLink="/">
      <ion-label>{{ a.tr.t({ko: '채팅앱 설치하기', en: 'Install Chat App'}) }}</ion-label>
      <ion-icon name="appstore"></ion-icon>
    </ion-button>
  </ion-card-content>
</ion-card>







<div class="loader" *ngIf=" show.loader.roomList; else roomListLoaded ">
  <ion-spinner></ion-spinner>
  <div>{{ a.tr.t({ko: '채팅방 목록을 로딩중입니다.', en: 'Loading chat room list.'}) }}</div>
</div>


<ng-template #roomListLoaded>

  <ion-toolbar *ngIf=" roomType == 'all-rooms' ">
    <ion-searchbar #searchBar (ionCancel)=" onCancelSearch() " (ionClear)=" onCancelSearch() " (ionChange)=" onSearch( searchBar.value ) "
      debounce="500" animated="true" autocomplete="on" placeholder="{{ a.tr.t({ko: '채팅방 검색', en: 'Search chat rooms' }) }}"></ion-searchbar>
  </ion-toolbar>

  <ion-list lines="full" class="rooms" *ngIf=" rooms.length ">
    <!-- <ion-item *ngFor="let room of rooms" (click)="enter.emit(room)"> -->
    <!-- <ion-item *ngFor="let room of rooms" (click)="onClickRoom(room)"> -->
    <ng-container *ngFor="let room of rooms">
      <ion-item class="name pointer" (click)=" onClickRoom(room.idx) ">
        <ion-label>
          <h3>{{ room.name }}</h3>
          <p>{{ room.description }}</p>
        </ion-label>
        <ion-icon color="tertiary" name="ribbon" *ngIf=" room.idx_owner && room.idx_owner == philgo.myIdx() "></ion-icon>
        <ion-icon color="primary" name="heart" *ngIf=" room.idx_owner != philgo.myIdx() && room.favorite == 'Y' "></ion-icon>
        <ng-container *ngIf=" roomType == 'all-rooms' ">
          <ion-badge *ngIf=" a.number(room.no_of_member) > 0 && a.number(room.no_of_member) <= 10 " color="light">{{ room.no_of_member }}</ion-badge>
          <ion-badge *ngIf=" a.number(room.no_of_member) > 10" color="dark">{{ room.no_of_member }}</ion-badge>
        </ng-container>
        <ng-container *ngIf=" roomType == 'my-rooms' ">
          <ion-badge slot="end" color="danger" *ngIf=" room.no_of_unread_messages != '0' ">{{ room.no_of_unread_messages }}</ion-badge>
        </ng-container>
      </ion-item>

      <!-- <ion-item class="meta pointer" (click)=" onClickRoom(room.idx) ">
        <ion-text text-wrap>{{ room.description }}</ion-text>
        <ng-container *ngIf=" roomType == 'my-rooms' ">
          <ion-badge slot="end" color="danger" *ngIf=" room.no_of_unread_messages != '0' ">{{ room.no_of_unread_messages }}</ion-badge>
        </ng-container>
      </ion-item> -->

    </ng-container>
  </ion-list>

  <div class="no-more" text-center *ngIf=" ! rooms.length ">
    <ion-img src="/assets/img/chat-icon.png"></ion-img>
    <ng-container *ngIf=" roomType == 'my-rooms' ">
      <ion-text color="danger" class="title">{{ a.tr.t({ko: '앗 ...?!', en: 'Oops ... ?!'}) }}</ion-text>
      <ion-text>{{ a.tr.t({ko: '회원님이 참여한 채팅 방이 없네요.', en: 'You do not have any rooms.'}) }}</ion-text>
      <ion-text>{{ a.tr.t({ko: '전체 채팅방 목록 메뉴에서 채팅방에 참여해보세요.', en: 'Please join a room under All Chat Room List menu.'}) }}</ion-text>
      <ion-button routerLink="/all-rooms">
        <span>{{ a.tr.t({ko: '전체 채팅방 목록', en:'All Chat Room List' }) }}</span>
        <ion-icon name="open"></ion-icon>
      </ion-button>
    </ng-container>
    <ng-container *ngIf=" roomType == 'all-rooms' ">
      <ion-text color="danger" class="title">{{ a.tr.t({ko: '앗 ...?!', en: 'Oops ... ?!'}) }}</ion-text>
      <ion-text>{{ a.tr.t({ko: '채팅방이 검색되지 않습니다. 다른 단어로 검색해 보세요.', en: 'There is no chat room by the serarch. Try other words.'}) }}</ion-text>
    </ng-container>
  </div>
</ng-template>

<a *ngIf=" a.isMobileWeb " class="mobileWeb-install-button" href="https://play.google.com/store/apps/details?id=com.sonub.chat" target="_blank">
  <span>{{ a.tr.t({ko: '채팅앱 이용하기', en: 'Use chat app'})}}</span>
  <ion-icon name="appstore"></ion-icon>
</a>
