<ion-header>
  <ion-toolbar padding-horizontal>
    <ion-buttons slot="start">
      <ion-button routerLink="/">
        <ion-icon name="arrow-round-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>
      <ion-spinner *ngIf=" ! roomInfo.name "></ion-spinner>
      <ng-container *ngIf=" roomInfo.name ">
        {{ roomInfo.name }}
        <ion-badge>{{ roomInfo.no_of_member }}</ion-badge>
      </ng-container>
    </ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="presentRoomOptions()">
        <ion-icon name="settings"></ion-icon>
      </ion-button>
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-scroll #ionScroll padding>
    <div class="messages" *ngIf=" messages.length ">
      <div class="message p-2" *ngFor=" let message of messages ">

        <!-- {{ message | json }} -->
        <ng-container *ngIf=" message.type != 'sending-file' ">
          <div class="other" text-left *ngIf="message.idx_member != philgo.myIdx(); ">
            <div class="left">
                <ion-avatar *ngIf=" message.photoUrl ">
                  <img src="{{ message.photoUrl }}">
                </ion-avatar>
            </div>
              <div class="right">
                <div class="title">
                    <span class="name">{{message.name}}</span>
                    <span class="date fs-sm">{{message.stamp | date:'short'}}</span>
                </div>
                <div class="content">
                    <ion-spinner *ngIf=" ! message.idx "></ion-spinner>
                    <div text-wrap [innerHTML]="message.message" *ngIf="message.message"></div>
                    <div class="uploaded-photo">
                      <img text-wrap [src]="message.url" *ngIf="message.url">
                    </div>
                </div>
              </div>
          </div>

          
          <div class="my" text-right *ngIf="message.idx_member == philgo.myIdx(); ">
            <!-- <span class="name">Me</span>
                  <span class="date fs-xl">{{ message.stamp | date:'short'}}</span> -->
            <!-- {{ message.idx }} -->

            <ion-spinner *ngIf=" ! message.idx "></ion-spinner>
            <div text-wrap [innerHTML]="message.message" *ngIf="message.message"></div>
            <div class="uploaded-photo">
              <img text-wrap [src]="message.url" *ngIf="message.url">
            </div>
            <div *ngIf=" message['percentage'] ">{{ message['percentage'] }}%</div>
          </div>


        </ng-container>
        <app-send-file text-right *ngIf=" message.type == 'sending-file' " [message]="message"></app-send-file>
      </div>
    </div>
  </ion-scroll>
</ion-content>

<ion-footer>
  <div class="message-input-box">
    <div class="camera-wrapper">
      <ion-icon class="camera" name="camera"></ion-icon>
      <input class="filebox" type="file" name="file" (change)="onChangeFile($event)">
    </div>
    <ion-input type="text" placeholder="Type a message" [(ngModel)]="form.message" name="message" (keyup.enter)="onClickSendMessage()"></ion-input>
    <ion-icon class="send" name="paper-plane" (click)="onClickSendMessage()"></ion-icon>
  </div>
</ion-footer>